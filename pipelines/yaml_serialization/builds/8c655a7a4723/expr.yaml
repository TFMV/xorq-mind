definitions:
  schemas:
    schema_0:
      region:
        name: String
        nullable: true
      total_sales:
        name: Float64
        nullable: true
      avg_price:
        name: Float64
        nullable: true
    schema_1:
      date:
        name: Timestamp
        nullable: true
      product_id:
        name: Int64
        nullable: true
      customer_id:
        name: Int64
        nullable: true
      quantity:
        name: Int64
        nullable: true
      unit_price:
        name: Float64
        nullable: true
      region:
        name: String
        nullable: true
      total_price:
        name: Float64
        nullable: true
  nodes:
    994b69827394395f3fd7e6d772f90a8c:
      op: Field
      name: unit_price
      relation:
        op: Read
        method_name: read_parquet
        name: sales_data
        schema_ref: schema_1
        profile: 2eca7579af9a9d8e315faf6af1ddb59a_6
        read_kwargs:
        - - source_list
          - /Users/thomasmcgeehan/xorq-mind/pipelines/datasets/sales.parquet
        - - table_name
          - sales_data
      type:
        name: Float64
        nullable: true
    8d15aab1e89f4f565039e42b26bbb669:
      op: Filter
      parent:
        op: Read
        method_name: read_parquet
        name: sales_data
        schema_ref: schema_1
        profile: 2eca7579af9a9d8e315faf6af1ddb59a_6
        read_kwargs:
        - - source_list
          - /Users/thomasmcgeehan/xorq-mind/pipelines/datasets/sales.parquet
        - - table_name
          - sales_data
      predicates:
      - op: Greater
        args:
        - node_ref: 994b69827394395f3fd7e6d772f90a8c
        - op: Literal
          value: 100
          type:
            name: Int8
            nullable: true
        type:
          name: Boolean
          nullable: true
    7052300e36b60b3c2e128b11feb5c1ac:
      op: Field
      name: region
      relation:
        node_ref: 8d15aab1e89f4f565039e42b26bbb669
      type:
        name: String
        nullable: true
    74f22e9fe5dcff87333e80615a5cda81:
      op: Field
      name: total_price
      relation:
        node_ref: 8d15aab1e89f4f565039e42b26bbb669
      type:
        name: Float64
        nullable: true
    cf32eb6f7343d2c01d2d9936fc2b4d68:
      op: Field
      name: unit_price
      relation:
        node_ref: 8d15aab1e89f4f565039e42b26bbb669
      type:
        name: Float64
        nullable: true
    62564de2234647e53392d37466902147:
      op: Field
      name: total_sales
      relation:
        op: Aggregate
        parent:
          node_ref: 8d15aab1e89f4f565039e42b26bbb669
        by:
        - node_ref: 7052300e36b60b3c2e128b11feb5c1ac
        metrics:
          total_sales:
            op: Sum
            type:
              name: Float64
              nullable: true
            args:
            - node_ref: 74f22e9fe5dcff87333e80615a5cda81
          avg_price:
            op: Mean
            type:
              name: Float64
              nullable: true
            args:
            - node_ref: cf32eb6f7343d2c01d2d9936fc2b4d68
      type:
        name: Float64
        nullable: true
expression:
  op: Sort
  parent:
    op: Aggregate
    parent:
      node_ref: 8d15aab1e89f4f565039e42b26bbb669
    by:
    - node_ref: 7052300e36b60b3c2e128b11feb5c1ac
    metrics:
      total_sales:
        op: Sum
        type:
          name: Float64
          nullable: true
        args:
        - node_ref: 74f22e9fe5dcff87333e80615a5cda81
      avg_price:
        op: Mean
        type:
          name: Float64
          nullable: true
        args:
        - node_ref: cf32eb6f7343d2c01d2d9936fc2b4d68
  keys:
  - op: SortKey
    arg:
      node_ref: 62564de2234647e53392d37466902147
    ascending: false
    nulls_first: false
    type:
      name: Float64
      nullable: true
  schema_ref: schema_0
