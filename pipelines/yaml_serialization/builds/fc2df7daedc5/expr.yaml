definitions:
  schemas:
    schema_0:
      region:
        name: String
        nullable: true
      date:
        name: Timestamp
        nullable: true
      daily_sales:
        name: Float64
        nullable: true
      avg_order_value:
        name: Float64
        nullable: true
      num_transactions:
        name: Int64
        nullable: true
    schema_1:
      date:
        name: Timestamp
        nullable: true
      product_id:
        name: Int64
        nullable: true
      customer_id:
        name: Int64
        nullable: true
      quantity:
        name: Int64
        nullable: true
      unit_price:
        name: Float64
        nullable: true
      region:
        name: String
        nullable: true
      total_price:
        name: Float64
        nullable: true
  nodes:
    c3fbedc1f94f8da969d1edcf15a7f342:
      op: Field
      name: unit_price
      relation:
        op: DatabaseTable
        table: ibis_read_parquet_3etv55efrnbzbap4eccci7ubqi
        schema_ref: schema_1
        profile: 2eca7579af9a9d8e315faf6af1ddb59a_6
        namespace:
          catalog: null
          database: null
      type:
        name: Float64
        nullable: true
    831003077c9af6b5fa9cd992ae632e0b:
      op: Filter
      parent:
        op: DatabaseTable
        table: ibis_read_parquet_3etv55efrnbzbap4eccci7ubqi
        schema_ref: schema_1
        profile: 2eca7579af9a9d8e315faf6af1ddb59a_6
        namespace:
          catalog: null
          database: null
      predicates:
      - op: Greater
        args:
        - node_ref: c3fbedc1f94f8da969d1edcf15a7f342
        - op: Literal
          value: 100
          type:
            name: Int8
            nullable: true
        type:
          name: Boolean
          nullable: true
    23b1187135830f2c5fc07e9e5fc629bc:
      op: Field
      name: region
      relation:
        node_ref: 831003077c9af6b5fa9cd992ae632e0b
      type:
        name: String
        nullable: true
    7b01b9126ae5b18b124838df68175922:
      op: Field
      name: date
      relation:
        node_ref: 831003077c9af6b5fa9cd992ae632e0b
      type:
        name: Timestamp
        nullable: true
    83e95b1d621b1e4c0b4a05c257554dc6:
      op: Field
      name: total_price
      relation:
        node_ref: 831003077c9af6b5fa9cd992ae632e0b
      type:
        name: Float64
        nullable: true
    94e84dd7fcb73fd9019149c839e960ee:
      op: Field
      name: region
      relation:
        op: Aggregate
        parent:
          node_ref: 831003077c9af6b5fa9cd992ae632e0b
        by:
        - node_ref: 23b1187135830f2c5fc07e9e5fc629bc
        - node_ref: 7b01b9126ae5b18b124838df68175922
        metrics:
          daily_sales:
            op: Sum
            type:
              name: Float64
              nullable: true
            args:
            - node_ref: 83e95b1d621b1e4c0b4a05c257554dc6
          avg_order_value:
            op: Mean
            type:
              name: Float64
              nullable: true
            args:
            - node_ref: 83e95b1d621b1e4c0b4a05c257554dc6
          num_transactions:
            op: CountStar
            type:
              name: Int64
              nullable: true
            args:
            - node_ref: 831003077c9af6b5fa9cd992ae632e0b
      type:
        name: String
        nullable: true
    4b2bccb6c303e90fc9c1428221944111:
      op: Field
      name: date
      relation:
        op: Aggregate
        parent:
          node_ref: 831003077c9af6b5fa9cd992ae632e0b
        by:
        - node_ref: 23b1187135830f2c5fc07e9e5fc629bc
        - node_ref: 7b01b9126ae5b18b124838df68175922
        metrics:
          daily_sales:
            op: Sum
            type:
              name: Float64
              nullable: true
            args:
            - node_ref: 83e95b1d621b1e4c0b4a05c257554dc6
          avg_order_value:
            op: Mean
            type:
              name: Float64
              nullable: true
            args:
            - node_ref: 83e95b1d621b1e4c0b4a05c257554dc6
          num_transactions:
            op: CountStar
            type:
              name: Int64
              nullable: true
            args:
            - node_ref: 831003077c9af6b5fa9cd992ae632e0b
      type:
        name: Timestamp
        nullable: true
expression:
  op: Sort
  parent:
    op: Aggregate
    parent:
      node_ref: 831003077c9af6b5fa9cd992ae632e0b
    by:
    - node_ref: 23b1187135830f2c5fc07e9e5fc629bc
    - node_ref: 7b01b9126ae5b18b124838df68175922
    metrics:
      daily_sales:
        op: Sum
        type:
          name: Float64
          nullable: true
        args:
        - node_ref: 83e95b1d621b1e4c0b4a05c257554dc6
      avg_order_value:
        op: Mean
        type:
          name: Float64
          nullable: true
        args:
        - node_ref: 83e95b1d621b1e4c0b4a05c257554dc6
      num_transactions:
        op: CountStar
        type:
          name: Int64
          nullable: true
        args:
        - node_ref: 831003077c9af6b5fa9cd992ae632e0b
  keys:
  - op: SortKey
    arg:
      node_ref: 94e84dd7fcb73fd9019149c839e960ee
    ascending: true
    nulls_first: false
    type:
      name: String
      nullable: true
  - op: SortKey
    arg:
      node_ref: 4b2bccb6c303e90fc9c1428221944111
    ascending: true
    nulls_first: false
    type:
      name: Timestamp
      nullable: true
  schema_ref: schema_0
